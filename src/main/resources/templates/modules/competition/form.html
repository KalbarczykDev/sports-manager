<!-- @thymesVar id="competition" type="dev.kalbarczyk.sportsmanager.competition.model.Competition" -->
<!--/*@thymesVar id="formAction" type="java.lang.String"*/-->
<!--/*@thymesVar id="methodOverride" type="java.lang.String"*/-->
<!--/*@thymesVar id="disciplines" type="java.util.List<dev.kalbarczyk.sportsmanager.person.enums.Discipline>"*/-->

<div th:fragment="content" class="container my-5">
    <!-- Header Section -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="fw-bold text-primary"
            th:text="${competition.id} != null ? 'Edit Competition' : 'Add New Competition'">
            Add/Edit Competition
        </h1>
        <button type="button" onclick="history.back()" class="btn btn-secondary">
            Back
        </button>
    </div>


    <!-- Form Card -->
    <div class="card shadow-sm">
        <div class="card-body">
            <form th:object="${competition}" th:action="@{${formAction}}" method="post" novalidate>
                <input type="hidden" name="_method" th:value="${methodOverride}"/>

                <!-- Global errors -->
                <div th:if="${#fields.hasGlobalErrors()}" class="alert alert-danger">
                    <p th:each="err : ${#fields.globalErrors()}" th:text="${err}"></p>
                </div>

                <!-- Name -->
                <div class="mb-3">
                    <label for="name" class="form-label">Competition Name</label>
                    <input type="text" id="name" th:field="*{name}" class="form-control" required>
                    <div class="text-danger small" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></div>
                </div>

                <!-- Discipline -->
                <div class="mb-3">
                    <label for="discipline" class="form-label">Discipline</label>
                    <select id="discipline" th:field="*{discipline}" class="form-select" required>
                        <option value="">-- Select Discipline --</option>
                        <option th:each="disciplineEnum : ${disciplines}"
                                th:value="${disciplineEnum.name()}"
                                th:text="${disciplineEnum.label}">
                        </option>
                    </select>
                    <div class="text-danger small" th:if="${#fields.hasErrors('discipline')}"
                         th:errors="*{discipline}"></div>
                </div>

                <!-- Date -->
                <div class="mb-3">
                    <label for="date" class="form-label">Date</label>
                    <input type="date" id="date" th:field="*{date}" class="form-control" required>
                    <div class="text-danger small" th:if="${#fields.hasErrors('date')}" th:errors="*{date}"></div>
                </div>

                <!-- Competitors (read-only list) -->
                <div class="mb-3">
                    <label class="form-label">Competitors</label>
                    <ul class="list-group">
                        <li th:each="competitor : ${competition.competitors}"
                            th:text="${competitor.name + ' ' + competitor.surname + ' (' + competitor.country + ')'}"
                            class="list-group-item">
                            Competitor
                        </li>
                        <li th:if="${#lists.isEmpty(competition.competitors)}" class="list-group-item text-muted">
                            No competitors assigned
                        </li>
                    </ul>
                </div>

                <!-- Submit -->
                <button type="submit" class="btn btn-success"
                        th:text="${competition.id} != null ? 'Update Competition' : 'Add Competition'">
                    Add/Update Competition
                </button>
            </form>
        </div>
    </div>
</div>